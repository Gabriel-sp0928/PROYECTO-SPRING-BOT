<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" layout:decorate="~{layout}">
<head>
    <title>Productos - Industria Gafra</title>
</head>
<body>
<div layout:fragment="content">
    <div class="flex items-center justify-between mb-6">
        <div>
            <h1 class="text-3xl font-bold">Productos</h1>
            <p class="text-sm text-[#9aa4ad]">Explora y administra tu inventario</p>
        </div>
        <div class="flex items-center gap-3">
            <form method="get" action="/products" class="flex items-center gap-2">
                <input id="productSearch" name="q" placeholder="Buscar por nombre o categoría..." th:value="${q}" class="search-input text-sm px-3 py-2 rounded-md" />
                <button type="submit" class="btn-outline-light px-4 py-2 rounded-md">Buscar</button>
            </form>
            <a href="/products/new" class="btn-outline-light px-4 py-2 rounded-md" sec:authorize="hasAnyRole('ADMIN','LOGISTICS')">Agregar producto</a>
        </div>
    </div>

    <div class="card-modern p-4">
        <div class="overflow-x-auto">
            <table class="min-w-full table-fixed text-sm">
                <thead>
                <tr class="text-left text-[#9aa4ad]">
                    <th class="w-2/5 pb-3">Nombre</th>
                    <th class="w-1/5 pb-3">Categoría</th>
                    <th class="w-1/6 pb-3">Precio</th>
                    <th class="w-1/6 pb-3">Stock</th>
                    <th class="w-1/6 pb-3 text-right">Acciones</th>
                </tr>
                </thead>
                <tbody id="productsTable" class="align-top">
                <tr th:each="p : ${products}" class="border-t border-white/4">
                    <td class="py-3">
                        <div class="font-medium" th:text="${p.name}"></div>
                        <div class="text-sm text-[#9aa4ad]" th:text="${p.description}"></div>
                    </td>
                    <td class="py-3" th:text="${p.category}"></td>
                    <td class="py-3" th:text="${p.price}"></td>
                    <td class="py-3" th:text="${p.stock}"></td>
                    <td class="py-3 text-right">
                        <a class="btn-outline-light text-sm mr-2" title="Ver" th:href="@{/products/{id}(id=${p.id})}"><i class="fa fa-eye"></i></a>
                        <a class="btn-outline-light text-sm mr-2" title="Editar" th:href="@{/products/{id}/edit(id=${p.id})}" sec:authorize="hasAnyRole('ADMIN','LOGISTICS')"><i class="fa fa-edit"></i></a>
                        <form th:action="@{/products/{id}/delete(id=${p.id})}" method="post" style="display:inline" class="confirm-delete" th:attr="data-message=${'Eliminar producto #' + p.id + '?'}" sec:authorize="hasAnyRole('ADMIN','LOGISTICS')">
                            <button type="submit" class="btn-outline-light text-sm text-red-400" title="Eliminar"><i class="fa fa-trash"></i></button>
                        </form>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>

</div>
</body>
</html>